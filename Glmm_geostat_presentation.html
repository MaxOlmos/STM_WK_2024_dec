<!DOCTYPE html>
<html lang="en"><head>
<script src="Glmm_geostat_presentation_files/libs/clipboard/clipboard.min.js"></script>
<script src="Glmm_geostat_presentation_files/libs/quarto-html/tabby.min.js"></script>
<script src="Glmm_geostat_presentation_files/libs/quarto-html/popper.min.js"></script>
<script src="Glmm_geostat_presentation_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="Glmm_geostat_presentation_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Glmm_geostat_presentation_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="Glmm_geostat_presentation_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="Glmm_geostat_presentation_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.433">

  <meta name="author" content="Maxime Olmos, Baptiste Alglave &amp; Etienne Rivot">
  <title>Spatio-Temporal Modelling using Generalised Linear Mixed Effects Models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="Glmm_geostat_presentation_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="Glmm_geostat_presentation_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="Glmm_geostat_presentation_files/libs/revealjs/dist/theme/quarto.css">
  <link href="Glmm_geostat_presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="Glmm_geostat_presentation_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="Glmm_geostat_presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="Glmm_geostat_presentation_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="Glmm_geostat_presentation_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="Glmm_geostat_presentation_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" =""="" class="quarto-title-block center">
  <h1 class="title">Spatio-Temporal Modelling using Generalised Linear Mixed Effects Models</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Maxime Olmos, Baptiste Alglave &amp; Etienne Rivot 
</div>
</div>
</div>

</section>
<section id="why" class="slide level2">
<h2>WHY</h2>
<div>
<ul>
<li class="fragment"><p>Application in the field of ecology is species distribution models (SDMs)</p>
<ul>
<li class="fragment">Predicts variation in density <span class="math inline">\(\mu_{s,t}\)</span> across multiple locations 𝑠 and time intervals 𝑡</li>
</ul></li>
<li class="fragment"><p>Applicable to other fields and any geostatistical data collected continuously in space and approximated in discrete time-intervals</p></li>
<li class="fragment"><p><img data-src="input_images/Table1_VAST.PNG"> &nbsp;<em>From&nbsp;Thorson&nbsp;2019,</em> <a href="https://doi.org/10.1016/j.fishres.2018.10.013" class="uri">https://doi.org/10.1016/j.fishres.2018.10.013</a><br>
</p></li>
</ul>
</div>
</section>
<section id="what-12-glmms-with-spatial-and-spatiotemporal-random-fields" class="slide level2">
<h2>WHAT (1/2) GLMMs with Spatial and Spatiotemporal Random Fields</h2>
<div>
<ul>
<li class="fragment"><p>GLMM <em>Generalized Mixed effects Models</em></p>
<ul>
<li class="fragment"><p>Hierarchical models</p></li>
<li class="fragment"><p>Measured variables : predictors in a model (ex: measuring and modelling temperature effects on species abundance)</p></li>
<li class="fragment"><p>Unmeasured (Latent) Variables: can cause residual spatial correlations</p></li>
</ul></li>
<li class="fragment"><p>Geostatistical GLMM</p>
<ul>
<li class="fragment">With spatially correlated random effects are good tools to account for residual spatial correlation</li>
</ul></li>
<li class="fragment"><p><strong>But</strong> computationally challenging</p>
<ul>
<li class="fragment">Due to the need to invert large matrices to account for covariation when evaluating the multivariate normal density function</li>
</ul></li>
<li class="fragment"><p><strong>Solution</strong> Use the SPDE approach to approximate Gaussian random fields</p>
<ul>
<li class="fragment">where the random effects describing the spatial patterning are assumed to be drawn from a multivariate normal distribution,</li>
<li class="fragment">constrained by covariance functions such as the exponential or Matérn</li>
</ul></li>
</ul>
</div>
</section>
<section id="what-22-model-description" class="slide level2">
<h2>WHAT (2/2) Model description</h2>
<ol type="1">
<li><p>Latent process</p></li>
<li><p>Parameters</p></li>
<li><p>Link function and observation error distributions</p></li>
</ol>
</section>
<section id="what-22-model-description-1" class="slide level2">
<h2>WHAT (2/2) Model description</h2>
<ol type="1">
<li>Latent process : linear predictors</li>
</ol>
<p><span class="math display">\[
\begin{split}
p_{s,t} =&amp;\underbrace{\ β_t}_{\text{Temporal variation = average temporal effect}}
+ \underbrace{ ω_s}_{\text{Spatial variation = niche effect}}
+ \underbrace{ε_{s,t}}_{\text{Spatio-temporal variation = non obs. environmental effects}}
+ \underbrace{X_{s,t} \ β}_{\text{covariates effects}}\\
\end{split}
\]</span></p>
</section>
<section id="what-22-model-description-2" class="slide level2">
<h2>WHAT (2/2) Model description</h2>
<ol type="1">
<li><p>Latent process : linear predictors</p></li>
<li><p>Parameters</p></li>
</ol>
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">Latent Spatial components</a></li><li><a href="#tabset-1-2">Latent Spatio temp components</a></li><li><a href="#tabset-1-3">Spatial Covariance</a></li><li><a href="#tabset-1-4">Latent Temp components</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<p><span class="math display">\[
  \begin{split}
\underbrace{ ω_s}_{\text{Spatial variation}}  \sim MVN(0,Σ_{ω})\\
\end{split}
\]</span></p>
</div>
<div id="tabset-1-2">
<p><span class="math display">\[
  \begin{split}
\underbrace{ ε_{s,t} }_{\text{Spatiotemporal variation}}  \sim MVN(0,Σ_{ε})
\end{split}
\]</span></p>
</div>
<div id="tabset-1-3">
<ul>
<li><u><strong>random effects</strong></u> describing the spatial patterning are assumed to be drawn from a <u><strong>multivariate normal distribution</strong></u> constrained by <u><strong>covariance functions</strong></u></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="input_images/matern.png" width="500"></p>
</figure>
</div>
</div>
<div id="tabset-1-4">
<p><span class="math display">\[
\begin{split}
\underbrace{\ β (t)}_{\text{Average temporal variation : fixed effect, IID, RW, AR }} \\  
\end{split}
\]</span></p>
</div>
</div>
</div>
</section>
<section id="what-22-model-description-3" class="slide level2">
<h2>WHAT (2/2) Model description</h2>
<ol type="1">
<li><p>Latent process : linear predictors</p></li>
<li><p>Parameters</p></li>
<li><p>Link function and observation error distributions</p>
<ul>
<li><p>Link function <span class="math inline">\(g\)</span> <span class="math display">\[\mu_{s,t}=g^{-1}(p_{s,t}) \]</span></p></li>
<li><p>Likelihodd functions</p>
<ul>
<li>The expected value <span class="math inline">\(\mathbb{E[.]}\)</span> of an observation <span class="math inline">\(y\)</span> at coordinates in space <span class="math inline">\(s\)</span> and time <span class="math inline">\(t\)</span> is defined as the mean <span class="math inline">\(\mu_{s,t}\)</span></li>
</ul></li>
</ul></li>
</ol>
<p><span class="math display">\[
\mathbb{E}[y_{s,t}]= \mu_{s,t}
\]</span></p>
<p><span class="math display">\[
y_{s,t} \sim  L(mu_{s,t}, \theta)
\]</span> with <span class="math inline">\(L\)</span> any probability distribution and <span class="math inline">\(\theta\)</span> the parameters associated to this distribution</p>
</section>
<section id="how---geostatistical-glmm-packages" class="slide level2">
<h2>HOW - Geostatistical GLMM packages</h2>
<div>
<ul>
<li class="fragment"><p>lme4, glmmTMB commonly used (user friendly) but not SPDE approach</p></li>
<li class="fragment"><p><a href="https://github.com/James-Thorson-NOAA/VAST/wiki">VAST</a>, <a href="https://vast-lib.github.io/tinyVAST/index.html">tinyVAST</a>, inlabru : powerful, uses SPDE, but not user friendly</p>
<ul>
<li class="fragment"><p>for multiple categories 𝑐, <span class="math inline">\(\mu_{s,t,c}\)</span></p>
<ul>
<li class="fragment"><p>multiple species</p></li>
<li class="fragment"><p>multiple size/age/sex classes for each individual species</p></li>
<li class="fragment"><p>a mix of biological, physical, and fishery variables describing an ecosystem</p></li>
</ul></li>
</ul></li>
<li class="fragment"><p><a href="https://pbs-assess.github.io/sdmTMB/">sdmTMB</a> good candidate to fit spatiotemporal models</p></li>
</ul>
</div>
</section>
<section id="how---cookbook---a-friendly-advice" class="slide level2">
<h2>HOW - CookBook - A friendly advice</h2>
<div>
<ul>
<li class="fragment"><p>VAST, sdmTMB and tinyVAST has a LOT of options and can do a lot of things</p></li>
<li class="fragment"><p>Spatiotemporal models are complex because they combine spatial, temporal and spatiotemporal processes</p></li>
<li class="fragment"><p>Consequence : We will not present all the case studies and packages configurations</p></li>
<li class="fragment"><p>Our workshop strategy : 1 question = 1 model = 1 configuration</p></li>
</ul>
</div>
</section>
<section id="how---cookbook---the-different-steps" class="slide level2">
<h2>HOW - CookBook - The different steps</h2>

<img data-src="input_images/steps_sdmtmb.PNG" width="500" class="r-stretch quarto-figure-center"><p>~<em>From&nbsp;Anderson et al.2023,</em> <a href="https://doi.org/10.1101/2022.03.24.485545" class="uri">https://doi.org/10.1101/2022.03.24.485545</a>~<br>
</p>
</section>
<section id="how---cookbook---the-spatial-resolution-data-mesh-grid" class="slide level2">
<h2>HOW - CookBook - The Spatial resolution : data, mesh, grid</h2>
<div class="panel-tabset">
<ul id="tabset-2" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-2-1">Year Resolution</a></li><li><a href="#tabset-2-2">Spatial resolution</a></li><li><a href="#tabset-2-3">Data config</a></li><li><a href="#tabset-2-4">Rcode : the grids (1/2)</a></li><li><a href="#tabset-2-5">Rcode : the grids (2/2)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Load packages</span></span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">library</span>(VAST);</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="fu">library</span>(ggplot2);</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(dplyr);</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(viridis);</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">library</span>(<span class="st">"rnaturalearth"</span>);</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">library</span>(<span class="st">"rnaturalearthdata"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">library</span>(sf);</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="fu">library</span>(here)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># load data</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>example <span class="ot">=</span> <span class="fu">load_example</span>( <span class="at">data_set=</span><span class="st">"EBS_pollock"</span> )</span>
<span id="cb1-15"><a href="#cb1-15"></a>data_ex1 <span class="ot">&lt;-</span> example<span class="sc">$</span>sampling_data</span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># Some spatial stuff</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">"medium"</span>, <span class="at">returnclass =</span> <span class="st">"sf"</span>)</span>
<span id="cb1-19"><a href="#cb1-19"></a>xlims <span class="ot">&lt;-</span><span class="fu">range</span>(<span class="fu">pretty</span>(data_ex1<span class="sc">$</span>Lon))<span class="co">#range(pretty(Data_Geostat$Lon))</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>ylims <span class="ot">&lt;-</span><span class="fu">range</span>(<span class="fu">pretty</span>(data_ex1<span class="sc">$</span>Lat))<span class="co">#range(pretty(Data_Geostat$Lat))</span></span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co"># create dir</span></span>
<span id="cb1-23"><a href="#cb1-23"></a>dir <span class="ot">&lt;-</span> <span class="fu">here</span>()</span>
<span id="cb1-24"><a href="#cb1-24"></a>dir_ex1 <span class="ot">&lt;-</span>  <span class="fu">paste0</span>(dir,<span class="st">"/ex1/"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>Nber_year <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(data_ex1<span class="sc">$</span>Year))</span>
<span id="cb2-2"><a href="#cb2-2"></a>min_year <span class="ot">&lt;-</span> <span class="fu">min</span>(data_ex1<span class="sc">$</span>Year)</span>
<span id="cb2-3"><a href="#cb2-3"></a>max_year <span class="ot">&lt;-</span> <span class="fu">max</span>(data_ex1<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<table>
<thead>
<tr class="header">
<th>Number year</th>
<th>starting year</th>
<th>end year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>33</td>
<td>1982</td>
<td>2014</td>
</tr>
</tbody>
</table>
</div>
<div id="tabset-2-2">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_ex1 ) <span class="sc">+</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">geom_point</span>(<span class="fu">aes</span>(Lon, Lat), <span class="at">col=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="fu">geom_sf</span>(<span class="at">data=</span>world, <span class="at">col=</span><span class="cn">NA</span>, <span class="at">fill=</span><span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">coord_sf</span>(<span class="at">xlim =</span> xlims, <span class="at">ylim =</span> ylims)</span>
<span id="cb3-5"><a href="#cb3-5"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img data-src="Glmm_geostat_presentation_files/figure-revealjs/unnamed-chunk-3-1.png" width="480"></p>
</div>
</div>
</div>
<div id="tabset-2-3">
<p>REMINDER - Objective : Generating an abundance index using spatiotemporal survey data Region</p>
<ul>
<li><p>Provide footprint of your region of interest to run SPDE and generate knots</p></li>
<li><p>3 spatial resolutions :</p>
<ul>
<li><p>Data</p></li>
<li><p>Inference : knots</p></li>
<li><p>Extrapolation</p>
<ul>
<li>interpolate the predictionss from knotsto extrapolation grid cells, using the triangulated mesh constructed from knots (using INLA)</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="tabset-2-4">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># ??make_settings()</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>settings <span class="ot">=</span> <span class="fu">make_settings</span>( <span class="at">n_x =</span> <span class="dv">75</span>, <span class="co">#number of knots</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>                          <span class="at">Region =</span> example<span class="sc">$</span>Region,<span class="co"># the extrapolation grid</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>                          <span class="at">purpose =</span> <span class="st">"index2"</span>) <span class="co"># index of abundance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="input_images/grids.png" width="700"></p>
</figure>
</div>
</div>
<div id="tabset-2-5">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="input_images/knot.png" width="800"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="how---cookbook---glmm-with-zero-in-the-data-how-we-think" class="slide level2">
<h2>HOW - CookBook - GLMM with zero in the data , how we think</h2>
<div class="panel-tabset">
<ul id="tabset-3" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-3-1">Model : Latent process</a></li><li><a href="#tabset-3-2">Parameters</a></li><li><a href="#tabset-3-3">Link functions and observation error distributions</a></li><li><a href="#tabset-3-4">Diagnostics Model evaluation</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1">
<ul>
<li>How many predictors
<ul>
<li><p>2 predictors : Hurdle/delta (poisson linked)</p>
<ul>
<li><p>encounter probability</p></li>
<li><p>positive catch rate</p></li>
</ul></li>
<li><p>1 predictor</p></li>
</ul></li>
</ul>
</div>
<div id="tabset-3-2">
<ul>
<li>Spatial terms ?</li>
<li>Spatiotemporal terms ?</li>
<li>Covariates ? boat effect for Abundance index</li>
<li>Fixed effects for intercept ? Abundance index</li>
</ul>
<p><img data-src="input_images/sdmtmbcomponent.PNG" data-fig-align="center" width="800"> ~<em>From&nbsp;Anderson et al.2023,</em> <a href="https://doi.org/10.1101/2022.03.24.485545" class="uri">https://doi.org/10.1101/2022.03.24.485545</a>~<br>
</p>
</div>
<div id="tabset-3-3">
<ul>
<li><p>Link functions</p>
<ul>
<li><p>Poisson link delta model</p>
<ul>
<li><p>encounter probability : logit</p></li>
<li><p>positive catch rate : log</p></li>
</ul></li>
<li><p>1 predictor : log</p></li>
</ul></li>
<li><p>Observation distribution</p>
<ul>
<li><p>Poisson link delta model</p>
<ul>
<li><p>encounter probability : binomial</p></li>
<li><p>positive catch rate : lognormal (gamma)</p></li>
</ul></li>
<li><p>Tweedie</p></li>
</ul></li>
</ul>
</div>
<div id="tabset-3-4">
<ul>
<li><p>Diagnostics</p>
<ul>
<li>Maximum Final Grandient for all parameters is less then 10^-5</li>
<li>Convergence check</li>
<li>Hessian matrix positive</li>
<li>Check the sd of all parameters</li>
</ul></li>
<li><p>Residual checking</p>
<ul>
<li>Dharma : Simulation-based randomized-quantile residuals : QQ residual, residual vs model predictions</li>
</ul></li>
<li><p>AIC and/or Cross validation</p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="case-studies" class="slide level2">
<h2>CASE STUDIES</h2>
<div class="panel-tabset">
<ul id="tabset-4" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-4-1">Atelier 1</a></li><li><a href="#tabset-4-2">Atelier 2</a></li><li><a href="#tabset-4-3">Atelier 3</a></li><li><a href="#tabset-4-4">Atelier 4</a></li><li><a href="#tabset-4-5">Atelier 5</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1">
<p><strong>Question</strong> : Comprendre et représenter la variabilité spatio-temporelle des œufs des petits pélagiques (Martin Huret)</p>
<p><strong>Données de base</strong> : Séries temporelles de données brutes sur la concentration en oeufs d’anchois/sardine sur l’ensemble du golfe de Gascogne le long des radiales de la campagnes PELGAS (2000-2024), ou données interpolées selon méthode du blocking (gridmap). Les données sont également disponibles par stade de développement des oeufs (3 à 5 stades selon les années).</p>
<p><strong>Objectif</strong> : Proposer une représentation en faible dimension du jeu de données et analyser les patrons de variation principaux. La prise en compte de la mortalité des oeufs doit pouvoir être prise en compte pour une meilleure estimation de la ponte journalière. Méthode(s) proposée(s) : Méthode des EOFs déjà testée, donne des premiers résultats intéressants sur la caractérisation de changement dans les patrons de ponte. Que peuvent nous apporter d’autres types de modèles spatio-temporels</p>
</div>
<div id="tabset-4-2">
<p><strong>Question</strong> : Modéliser la variation spatiotemporelle de la condition corporelle chez les sardines et anchois (Aurélien Favreau)</p>
<p><strong>Données de base</strong> : Les données incluent des mesures de longueur et de poids de sardines dans le golfe de Gascogne sur la période 2000-2023. Ces données permettent de déterminer la condition corporelle des individus, basée sur les résidus d’une relation allométrique longueur-poids (facteur de condition de Le Cren). Objectif : Modéliser la distribution spatio-temporelle de la condition des sardines et explorer l’effet de la densité-dépendance et l’impact des changements environnementaux (température et qualité de la nourriture) sur la condition et la densité.</p>
<p><strong>Méthode(s) proposée(s)</strong> : GLMM spatio-temporel (VAST, tinyVAST)</p>
</div>
<div id="tabset-4-3">
<p><strong>Question</strong> : Classifier des données spatio-temporelles multivariées d’espèces marines pour identifier des zones fonctionnelles multispécifiques (Baptiste Alglave)</p>
<p><strong>Données de base</strong> : Séries temporelles de cartes sur l’ensemble du golfe de Gascogne pour un ensemble d’espèce (e.g.&nbsp;sole, merlan, encornet). Les séries temporelles sont constituées de 200 pas de temps (i.e.&nbsp;200 cartes).</p>
<p><strong>Objectif</strong> : Proposer une représentation en faible dimension du jeu de données et réaliser un classification dans cet espace. Interpréter les différents clusters en terme d’écologie des espèces (habitats essentiels / saisons écologiques).</p>
<p><strong>Méthode(s) proposée(s)</strong> : Etant donnée le caractére complexe et non-linéaire des processus écologiques, les méthodes tel que l’ACP sont limités dans ce cas là. Nous proposons de réduire la dimension de ses données et de réaliser la classification en se basant sur des méthodes de deep-learning type auto-encodeur variationnel (VAE). Tout autre méthode de deep learning (ou simplement d’apprentissage statistique) pourra être proposée pourvu qu’elle réponde à la question posée</p>
</div>
<div id="tabset-4-4">
<p><strong>Question</strong> : Construire des indices d’abondance à partir de données de campagnes scientifiques (espèce : Merlan – Paul Gatti, Youen Vermard)</p>
<p><strong>Objectif</strong> : Le principal objectif est de mettre à profit la série EVHOE (1997-2023) afin d’élaborer un indice d’abondance pour le merlan (Merlangius merlangus) dans le golfe de Gascogne via l’outil VAST. Les questions suivantes pourront être explorées : 1. Quelle(s) est (sont) les options de paramétrisation de VAST la (les) plus appropriée(s) ? 2. Quel est l’impact des années manquantes (e.g.&nbsp;avarie Thalassa en 2017) ? Peut-on s’en affranchir ? 3. Observe-t-on une tendance commune entre le Golfe de Gascogne et la mer Celtique ? 4. Un indice structuré en taille ou en âge ? 5. Comment prendre en compte des co-variables environnementales (profondeur et température de fond) ?</p>
<p><strong>Méthode(s)</strong> proposée(s) : GLMM spatio-temporel (sdmTMB , VAST)</p>
</div>
<div id="tabset-4-5">
<p><strong>Question</strong> : Analyser et modéliser des données spatio-temporelles de pêcheries à Madagascar (Sandra Ranaivomanana, Marc Leopold)</p>
<p><strong>Données de base</strong> : Les données proviennent du suivi permanent d’un échantillon d’une centaine de petits pêcheurs en pirogues à voile dans les récifs coralliens au sud-ouest de Madagascar (baie de Ranobe ~200 km²) entre octobre 2021 et janvier 2023 (16 mois consécutifs). Les informations ont été collectées i) tous les jours (poids total des captures et type d’engin de pêche) pour environ 20000 sorties de pêche et ii) au débarquement sur un sous-échantillon de 1000 sorties de pêche (diversité et taille des poissons récifaux). On recense plus de 245 espèces de poissons récifaux et répartis dans 75 familles. En parallèle, pour spatialiser les captures ci-dessus, les pirogues ont été équipées d’un traceur GPS enregistrant les positions chaque minute, permettant de distinguer précisément les sites de pêche par sortie. Chaque donnée de capture est ainsi associée à un ensemble de points latitude/longitude et heure/jour (environ 100-200 points par sortie) qui définit un effort de pêche effectif par engin. Enfin une cartographie des différents habitat marins associés aux récifs coralliens (polygones) est disponible. Toutes ces données sont disponibles dans une base PostGrSQL sur un serveur en ligne.</p>
<p><strong>Objectif</strong> : L’objectif est d’analyser la variation temporelle (mensuelle) de la distribution spatiale des captures par unité d’effort (CPUE en kg par minute de pêche), utilisées comme indice d’abondance. Afin d’alléger les analyses, les espèces pourront être agrégées i) dans leur globalité et/ou ii) dans des groupes fonctionnels définis selon leurs caractéristiques en rapport avec la taille : taille maximale (poisson de petite taille – poisson de grande taille) et/ou leur maturité sexuelle (poisson adulte et juvénile). Le type d’habitat (mangrove, lagon, herbier, récif) et la pression de pêche pourront être utilisés comme des facteurs explicatifs.</p>
<p><strong>Méthode(s) proposée(s)</strong> : sdmTMB</p>
</div>
</div>
</div>
</section>
<section id="ethics-and-mindset" class="slide level2">
<h2>Ethics and mindset</h2>
<ul>
<li><p>Participants</p>
<ul>
<li><p>Workshop are not yet pubished</p></li>
<li><p>Workshop Leaders are responsible for data. <strong>Please do not share or use those data outside of the workshop</strong></p></li>
<li><p>If you re-use the script for a futur project, please contact the workshop leader at the very least.</p></li>
</ul></li>
<li><p>Leaders</p>
<ul>
<li>If you publish your work, don’t forget the participants who have contributed a certain amount of work.</li>
</ul></li>
<li><p>These sessions are based on self-learning. It is normal if you have bugs. It is part of the learning.</p></li>
<li><p>We propose a framework for (1) learning about spatio-temporal models and (2) building a community related to spatio-temporal methods for ecology.</p></li>
<li><p>Finally : HAVE FUN</p></li>
</ul>
<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="Glmm_geostat_presentation_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
          // Handle positioning of the toggle
          window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>